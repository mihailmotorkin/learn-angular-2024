<!-- <app-counter-input [formControl]="counterForm"></app-counter-input> -->
<!-- {{counterForm.value}}
{{counterFormValue$ | async}} -->

<!-- {{counterForm.valid}}
{{counterForm.touched}}
{{counterForm.dirty}} -->

<!-- <app-counter-input [ngModel]="counter" (ngModelChange)="counter = $event"></app-counter-input> -->
<!-- <app-counter-input #ngModel="ngModel" [(ngModel)]="counter"></app-counter-input> -->

<!-- {{counter}}
{{ngModel.dirty}}
{{ngModel.valid}}
{{ngModel.touched}}
{{ngModel.value}} -->

<!-- <mat-form-field appearance="fill" class="search-input">
  <mat-label>Search</mat-label>
  <input matInput [formControl]="searchForm">
</mat-form-field> -->

<!-- {{searchForm.valid}} -->
<!-- {{searchForm.errors | json}} -->
<!-- {{searchFormErrors$ | async | json}} -->

<mat-form-field appearance="fill" class="search-input">
  <mat-label>Search</mat-label>
  <input matInput #ngModel="ngModel" appIsStringAsyncValidator required minlength="3" [(ngModel)]="searchName">
</mat-form-field>

{{ngModel.valid}}
{{ngModel.errors | json}}

<!-- <div *ngIf="products$ | async as products; else: loaderTemplate;" class="scroll__wrapper">
  <ng-container *appPagination="
                let productsGroup of products | filterByProperty : 'name' : ((searchFormValue$ | async) || '');
                chankSize: 4;
                let pageIndexes = pageIndexes;
                let activeIndex = index;
                let next = next;
                let back = back;
                let selectIndex = selectIndex"> -->

<div *ngIf="products$ | async as products; else: loaderTemplate;" class="scroll__wrapper">
  <ng-container *appPagination="
                let productsGroup of products | filterByProperty : 'name' : (searchName);
                chankSize: 4;
                let pageIndexes = pageIndexes;
                let activeIndex = index;
                let next = next;
                let back = back;
                let selectIndex = selectIndex">

    <div class="cards">
      <app-card *ngFor="
        let product of productsGroup 
        trackBy: trackById" class="card" [routerLink]="['/', 'product', product._id]" [product]="product"
        (buyProduct)="onBuyProduct($event)">
      </app-card>
    </div>
    <div class="pagination">
      <button mat-icon-button (click)="back()">
        <mat-icon>chevron_left</mat-icon>
      </button>
      <div class="pagination__page-number-container">
        <button *ngFor="
          let index of pageIndexes" mat-icon-button class="pagination__page-number"
          [class.pagination__page-number_active]="activeIndex === index" (click)="selectIndex(index)">
          {{ index + 1 }}
        </button>
      </div>
      <button mat-icon-button (click)="next()">
        <mat-icon>chevron_right</mat-icon>
      </button>
    </div>
  </ng-container>
</div>

<ng-template #loaderTemplate>
  <mat-spinner class="loader"></mat-spinner>
</ng-template>